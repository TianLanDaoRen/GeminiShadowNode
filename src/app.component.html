<div class="min-h-screen bg-gray-900 text-gray-200 flex flex-col items-center justify-center p-4">
  
  <div class="w-full max-w-2xl mx-auto">
    
    <!-- 极简 Header: Shadow Node Edition -->
    <header class="text-center mb-6">
      <h1 class="text-3xl sm:text-4xl font-bold tracking-tight font-mono">
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-gray-200 to-gray-400">Gemini</span>
        <span class="text-cyan-500 ml-2">Shadow Node</span>
      </h1>
      
      <div class="mt-2 flex justify-center gap-3 text-[10px] font-mono text-gray-600 uppercase tracking-widest">
        <span class="flex items-center gap-1">
          <span class="w-1.5 h-1.5 bg-cyan-900 rounded-full"></span>
          v2.0.0
        </span>
        <span>|</span>
        <span class="flex items-center gap-1">
          <span class="w-1.5 h-1.5 bg-purple-900 rounded-full"></span>
          Stealth Mode
        </span>
      </div>

      <!-- 【新增】集群状态显示 -->
      <div class="mt-6 flex justify-center">
        <div class="inline-flex items-center gap-4 px-4 py-2 bg-gray-900/80 border border-gray-700 rounded-lg shadow-lg backdrop-blur-md">
          
          <!-- 节点计数器 -->
          <div class="flex items-center gap-2">
            <div class="relative flex h-3 w-3">
              @if (nodeCount() > 0) {
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-purple-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-purple-500"></span>
              } @else {
                <span class="relative inline-flex rounded-full h-3 w-3 bg-gray-500"></span>
              }
            </div>
            <span class="text-xs font-mono text-gray-400 uppercase tracking-wider">Cluster Nodes:</span>
            <span class="text-lg font-bold font-mono text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400">
              {{ nodeCount() }}
            </span>
          </div>

          <!-- 分隔符 -->
          <div class="w-[1px] h-4 bg-gray-700"></div>

          <!-- 负载能力预估 (装逼用的，假设计算力翻倍) -->
          <div class="flex items-center gap-2">
             <span class="text-[10px] font-mono text-gray-500">CAPACITY:</span>
             <span class="text-xs font-mono text-cyan-400">{{ nodeCount() * 100 }}%</span>
          </div>

        </div>
      </div>
    </header>

    <!-- 主控制台 -->
    <main class="bg-gray-800/80 backdrop-blur-md rounded-xl shadow-2xl border border-gray-700 overflow-hidden">
      
      <!-- 状态栏 (顶部高亮条) -->
      <div class="h-1 w-full" 
           [class.bg-green-500]="connectionStatus() === 'connected'"
           [class.bg-yellow-500]="connectionStatus() === 'connecting'"
           [class.bg-red-500]="connectionStatus() === 'error'"
           [class.bg-gray-600]="connectionStatus() === 'disconnected'">
      </div>

      <div class="p-6 sm:p-8 space-y-6">

        <!-- 1. 连接控制区域 -->
        <div>
          <div class="flex justify-between items-center mb-2">
            <label for="ws-url" class="text-xs font-bold text-cyan-400 uppercase tracking-wider">中转服务器地址</label>
            <!-- 状态徽章 -->
            <div class="flex items-center gap-2 px-3 py-1 rounded-full bg-gray-900 border border-gray-700 text-xs font-mono">
              @if (connectionStatus() === 'connected') {
                <span class="h-2 w-2 rounded-full bg-green-500 animate-pulse"></span>
                <span class="text-green-400">ONLINE</span>
              } @else if (connectionStatus() === 'connecting') {
                <span class="h-2 w-2 rounded-full bg-yellow-500 animate-spin"></span>
                <span class="text-yellow-400">CONNECTING</span>
              } @else if (connectionStatus() === 'error') {
                <span class="h-2 w-2 rounded-full bg-red-500"></span>
                <span class="text-red-400">ERROR</span>
              } @else {
                <span class="h-2 w-2 rounded-full bg-gray-500"></span>
                <span class="text-gray-500">OFFLINE</span>
              }
            </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-2">
            <input 
              id="ws-url"
              type="text"
              [value]="relayUrl()" 
              (input)="updateRelayUrl($event)"
              [disabled]="connectionStatus() === 'connected' || connectionStatus() === 'connecting'"
              class="flex-grow p-3 bg-gray-900/50 border border-gray-600 rounded-lg text-sm font-mono focus:ring-2 focus:ring-cyan-500 focus:border-transparent outline-none transition-all disabled:opacity-50 disabled:cursor-not-allowed text-gray-300 placeholder-gray-600"
              placeholder="wss://...">
            
            @if (connectionStatus() === 'disconnected' || connectionStatus() === 'error') {
              <button 
                (click)="connect()"
                class="px-6 py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-semibold rounded-lg shadow-lg shadow-cyan-900/20 transition-all active:scale-95 whitespace-nowrap">
                启动连接
              </button>
            } @else {
              <button 
                (click)="disconnect()"
                class="px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-200 font-semibold rounded-lg border border-red-700 transition-all active:scale-95 whitespace-nowrap">
                断开
              </button>
            }
          </div>
        </div>

        <!-- 【新增】流式性能调优面板 -->
        <div class="mt-6 pt-4 border-t border-gray-800">
          <div class="flex justify-between items-center mb-2">
            <label class="text-xs font-bold text-purple-400 uppercase tracking-wider flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3">
                <path d="M15.98 1.804a1 1 0 00-1.96 0l-.24 1.192a1 1 0 01-.784.785l-1.192.238a1 1 0 000 1.962l1.192.238a1 1 0 01.785.785l.238 1.192a1 1 0 001.962 0l.238-1.192a1 1 0 01.785-.785l1.192-.238a1 1 0 000-1.962l-1.192-.238a1 1 0 01-.785-.785l-.238-1.192zM6.949 5.684a1 1 0 00-1.898 0l-.683 2.051a1 1 0 01-.633.633l-2.051.683a1 1 0 000 1.898l2.051.683a1 1 0 01.633.633l.683 2.051a1 1 0 001.898 0l.683-2.051a1 1 0 01.633-.633l2.051-.683a1 1 0 000-1.898l-2.051-.683a1 1 0 01-.633-.633L6.95 5.684z" />
              </svg>
              流式缓冲 (Buffer Latency)
            </label>
            <span class="text-xs font-mono" 
                  [class.text-green-400]="bufferInterval() <= 100"
                  [class.text-yellow-400]="bufferInterval() > 100 && bufferInterval() <= 500"
                  [class.text-blue-400]="bufferInterval() > 500">
              {{ bufferInterval() }} ms
            </span>
          </div>

          <div class="flex items-center gap-4">
            <input 
              type="range" 
              min="0" 
              max="2000" 
              step="50" 
              [value]="bufferInterval()" 
              (input)="updateBufferInterval($event)"
              class="w-full h-2 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-purple-500 hover:accent-purple-400 transition-all">
          </div>
          
          <div class="flex justify-between text-[10px] text-gray-600 font-mono mt-1">
            <span>0ms (Raw/High CPU)</span>
            <span>1000ms (Lazy/Low CPU)</span>
          </div>
        </div>

        <!-- 2. 实时日志区域 (极简版) -->
        <div>
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 flex justify-between items-center">
            <span>系统日志 (最新50条)</span>
            <span class="text-[10px] font-normal opacity-50">Auto-scroll</span>
          </h3>
          
          <div class="h-64 bg-gray-950 rounded-lg border border-gray-800 p-4 overflow-y-auto font-mono text-xs leading-5 shadow-inner custom-scrollbar">
            @if (logs().length === 0) {
              <div class="h-full flex flex-col items-center justify-center text-gray-700 gap-2">
                <svg class="w-8 h-8 opacity-20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                <span>等待任务...</span>
              </div>
            } @else {
              <div class="flex flex-col space-y-1">
                @for (log of logs(); track $index) {
                  <div class="break-all transition-opacity duration-500"
                       [class.text-teal-400]="log.includes('Connected')"
                       [class.text-red-400]="log.includes('Error')"
                       [class.text-gray-400]="!log.includes('Connected') && !log.includes('Error')"
                       [class.opacity-40]="$index > 20">
                    {{ log }}
                  </div>
                }
              </div>
            }
          </div>
        </div>

      </div>
      
      <!-- 底部状态条 -->
      <div class="bg-gray-900/50 px-6 py-2 text-[10px] text-gray-600 flex justify-between border-t border-gray-800">
        <span>Client: Angular (Pro Mode)</span>
        <span>Guard: WakeLock Active</span>
      </div>

    </main>
  </div>
</div>